---
layout: article
title: JWT ì´í•´í•˜ê¸°
article_header:
  type: overlay
  theme: dark
  background_color: "#203028"
  background_image:
    gradient: "linear-gradient(135deg, rgba(34, 139, 87 , .4), rgba(139, 34, 139, .4))"
    src: /assets/images/banners/jwt.png
author: SeoYeonii
categories: jwt
tags: [jwt]
# top: 1
# sidebar: []
---

> - ë³´ì•ˆì— í•„ìš”í•œ jwt ê¸°ë³¸ ê°œë… ì´í•´í•˜ê¸°

ê¸¸ì—ˆë˜ ë³‘ê°€ê°€ ëë‚˜ê³  ë‹¤ì‹œ ì¼ìƒìƒí™œë¡œ ëŒì•„ì™”ìŠµë‹ˆë‹¤.
í‡´ì›í•˜ë©´ ì–´ë–¤ ê²ƒë“¤ì„ í•´ë³¼ê¹Œ ê³ ë¯¼í•˜ë˜ ì¤‘, nextjsë¡œ frontendë¶€í„° backendê¹Œì§€ ë‚´ê°€ êµ¬í˜„í•´ì„œ ë¬´ì—‡ì¸ê°€ë¥¼ ë§Œë“¤ì–´ë´ì•¼ê² ë‹¤ëŠ” ìƒê°ì´ ë“¤ì—ˆìŠµë‹ˆë‹¤.

ê·¸ëŸ°ë°... ë§‰ìƒ backend ë¶€ë¶„ì„ êµ¬í˜„í•˜ë‹¤ ë³´ë‹ˆ ì €ëŠ” ì¸ì¦, ë³´ì•ˆ, ì„œë²„ ê°œë… ë“±ë“±ì— ëŒ€í•´ ìƒê°ë³´ë‹¤ ë§ì´ ëª¨ë¥´ê³  ìˆì—ˆë˜ê²ƒ ê°™ìŠµë‹ˆë‹¤..ğŸ¥²

ê·¸ë˜ì„œ ì˜¤ëŠ˜ì€ jwtì˜ ê¸°ë³¸ ê°œë…ì— ëŒ€í•´ ì •ë¦¬ë¥¼ í•˜ë˜, jwtì˜ ì—­ì‚¬ë‚˜ ê°œë…ì„ ê¹Šê²Œ íŒŒê¸°ë³´ë‹¤ëŠ” apië¥¼ êµ¬í˜„í•  ë•Œ í•„ìš”í•œ ê°œë…ë“¤ ìœ„ì£¼ë¡œ ì •ë¦¬í•˜ëŠ” ì‹œê°„ì„ ê°€ì§ˆê¹Œ í•©ë‹ˆë‹¤.

## ğŸ“Œ JWT (JSON Web Token)ë€?

JWTëŠ” ë¡œê·¸ì¸ ì¸ì¦ì„ ìœ„í•´ ì‚¬ìš©ë˜ëŠ” JSON object í˜•íƒœì˜ í† í°ìœ¼ë¡œ, ì‰½ê²Œ ë§í•´
í´ë¼ì´ì–¸íŠ¸ê°€ ë¡œê·¸ì¸í•˜ë©´ ì„œë²„ì—ì„œ JWTë¥¼ ìƒì„±í•´ì„œ ë°˜í™˜í•˜ê³ , ì´í›„ ìš”ì²­í•  ë•Œ ì´ í† í°ì„ í•¨ê»˜ ë³´ë‚´ì„œ "ë‚˜ëŠ” ì¸ì¦ëœ ì‚¬ìš©ìì•¼!" ë¼ëŠ” ê±¸ ì¦ëª…í•˜ëŠ” ë°©ì‹ì…ë‹ˆë‹¤.

### JWTë¥¼ ì‚¬ìš©í•˜ëŠ” ì´ìœ 

ê¸°ì¡´ì˜ ì¸ì¦ì²´ê³„ëŠ” ì£¼ë¡œ ì„¸ì…˜ ê¸°ë°˜ ì¸ì¦ì„ ì‚¬ìš©í–ˆì§€ë§Œ ë‹¨ì ì´ ë§ì•˜ìŠµë‹ˆë‹¤:

> - ì„œë²„ ë©”ëª¨ë¦¬ì— ì„¸ì…˜ì„ ì €ì¥í•´ì•¼ í•¨ â†’ ì‚¬ìš©ìê°€ ë§ì•„ì§€ë©´ ì„œë²„ ë¶€ë‹´ ì¦ê°€
> - ë¡œë“œ ë°¸ëŸ°ì‹± ë¬¸ì œ â†’ ì—¬ëŸ¬ ì„œë²„ê°€ ìˆìœ¼ë©´ ê°™ì€ ì„œë²„ì—ì„œ ë¡œê·¸ì¸í•´ì•¼ í•¨
> - CORS ì´ìŠˆ â†’ ë‹¤ë¥¸ ë„ë©”ì¸ì—ì„œëŠ” ì¿ í‚¤ë¥¼ ì‚¬ìš©í•˜ê¸° ì–´ë ¤ì›€

ê·¸ë˜ì„œ ë“±ì¥í•œ ê²ƒì´ ë°”ë¡œ JWT ê¸°ë°˜ ì¸ì¦ì…ë‹ˆë‹¤. JWTëŠ” ë§ ê·¸ëŒ€ë¡œ ì •ë³´ë¥¼ ë‹´ì„ ìˆ˜ ìˆëŠ” JSON objectì´ê¸° ë•Œë¬¸ì— ì‚¬ìš©ìì˜ ì •ë³´ë¥¼ ê·¸ ì•ˆì— ë‹´ì•„ ì „ë‹¬í•  ìˆ˜ ìˆìœ¼ë©°, ì„œë²„ëŠ” ë””ì½”ë”©ì„ í†µí•´ ì´ë¥¼ ê²€ì¦í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ëŸ° íŠ¹ì„± ë•Œë¬¸ì— JWTëŠ” ë‹¤ìŒê³¼ ê°™ì€ ì´ì ì„ ì œê³µí•©ë‹ˆë‹¤:

> - JWTë§Œ ìˆìœ¼ë©´ ì‚¬ìš©ì ê²€ì¦ ê°€ëŠ¥(í•„ìš” ë°ì´í„°ë¥¼ jwtì•ˆì— ë‹´ì•„ ì„œë²„ì— ì „ë‹¬í•  ìˆ˜ ìˆê¸° ë•Œë¬¸) -> ì„œë²„ê°€ ì‚¬ìš©ìë¥¼ ê¸°ì–µí•  í•„ìš” ì—†ìŒ
> - ì„œë²„ì— ëŒ€í•œ ì˜ì¡´ë„ê°€ ë‚®ìŒ -> í™•ì¥ì„± í–¥ìƒ

## ğŸ“Œ JWTì˜ êµ¬ì¡°

JWTëŠ” ì„¸ ë¶€ë¶„ìœ¼ë¡œ êµ¬ì„±ë˜ë©° ì´ ë¶€ë¶„ë“¤ì€ `.`ìœ¼ë¡œ êµ¬ë¶„ë©ë‹ˆë‹¤:

```
í—¤ë”(Header) . í˜ì´ë¡œë“œ(Payload) . ì„œëª…(Signature)
```

ğŸ‘‰ JWT ì˜ˆì œ:

```
xxxxx.yyyyy.zzzzz
```

### í—¤ë”(Header)

í—¤ë”ëŠ” JWTê°€ ì–´ë–¤ ì•Œê³ ë¦¬ì¦˜ìœ¼ë¡œ ì„œëª…ë˜ì—ˆëŠ”ì§€ ë‚˜íƒ€ë‚´ëŠ” ë¶€ë¶„ì…ë‹ˆë‹¤.

```json
{
  "alg": "HS256",
  "typ": "JWT"
}
```

- `alg`: ì„œëª…ì— ì‚¬ìš©í•  ì•Œê³ ë¦¬ì¦˜ (ì˜ˆ: HS256, RS256)
- `typ`: í† í° íƒ€ì… (í•­ìƒ JWT)

### í˜ì´ë¡œë“œ(Payload)

í˜ì´ë¡œë“œëŠ” **claim**ì´ë¼ê³  ë¶€ë¥´ëŠ” ì‚¬ìš©ìì˜ ì •ë³´ë¥¼ ë‹´ëŠ” ë¶€ë¶„ìœ¼ë¡œ, ì„œë²„ê°€ JWTì˜ ì´ í˜ì´ë¡œë“œë¥¼ ì½ì–´ì„œ ì‚¬ìš©ìë¥¼ ì¸ì¦í•©ë‹ˆë‹¤.

í˜ì´ë¡œë“œì˜ í‘œì¤€ ìŠ¤í™ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤:

- `iss (issuer)` : í† í° ë°œê¸‰ì
- `exp (expiration time)` : í† í° ë§Œë£Œ ì‹œê°„
- `sub (subject)` : í† í° ì œëª©(ì‚¬ìš©ì ì‹ë³„ ê°’)
- `aud (audience)` : í† í° ëŒ€ìƒì
- ë“±ë“±..

ê·¸ëŸ°ë° ì‚¬ì‹¤ ì´ í˜ì´ë¡œë“œì— ì–´ë–¤ claim ê°’ì„ ë„£ëŠ”ì§€ëŠ” ììœ ì´ê¸° ë•Œë¬¸ì— ìƒí™©ì— ë”°ë¼ í•„ìš”í•œ ê°’ì„ ë„£ì–´ì„œ ì‚¬ìš©í•˜ë©´ ë©ë‹ˆë‹¤.

> ex) upbitì˜ apiì—ì„œ ì‚¬ìš©í•˜ëŠ” í˜ì´ë¡œë“œ

```json
{
  "access_key": "ë°œê¸‰ ë°›ì€ acccess key (í•„ìˆ˜)",
  "nonce": "ë¬´ì‘ìœ„ì˜ UUID ë¬¸ìì—´ (í•„ìˆ˜)",
  "query_hash": "í•´ì‹±ëœ query string (íŒŒë¼ë¯¸í„°ê°€ ìˆì„ ê²½ìš° í•„ìˆ˜)",
  "query_hash_alg": "query_hashë¥¼ ìƒì„±í•˜ëŠ” ë°ì— ì‚¬ìš©í•œ ì•Œê³ ë¦¬ì¦˜ (ê¸°ë³¸ê°’ : SHA512)"
}
```

ì£¼ì˜í•  ê²ƒì€ ì´ **payloadì— ë¯¼ê°í•œ ì •ë³´ë¥¼ ë‹´ìœ¼ë©´ ì•ˆëœë‹¤**ë¼ëŠ” ê²ƒì…ë‹ˆë‹¤. í˜ì´ë¡œë“œëŠ” ê²°êµ­ ê·¸ëƒ¥ ì´ ì •ë³´ë“¤ì„ ì¸ì½”ë”©í•´ì„œ ë§Œë“  ë¬¸ìì—´ì´ê¸° ë•Œë¬¸ì— ëˆ„êµ¬ë‚˜ jwtë¥¼ ê°€ì§€ê³  ê·¸ ì†ì— ë‹´ê¸´ ì •ë³´ë¥¼ ì•Œì•„ë‚¼ ìˆ˜ ìˆê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.

<div style="display:flex; justify-content:center;">
<img src="/assets/images/post/jwt/jwt-decode.png" alt="ë””ì½”ë“œ í™”ë©´" style="width:300px;"/>
</div>

### ì„œëª…(Signature)

ì„œëª…ì€ JWTì˜ ë¬´ê²°ì„±ì„ ë³´ì¥í•˜ê¸° ìœ„í•œ ë¶€ë¶„ìœ¼ë¡œ ì´ JWTì˜ ë‚´ìš©ì„ ì•„ë¬´ë‚˜ ë³€ê²½í•  ìˆ˜ ì—†ê²Œ í•˜ê¸° ìœ„í•´ í•„ìš”í•œ ë¶€ë¶„ì…ë‹ˆë‹¤.

ë§Œì•½ HMACSHA256 ì•Œê³ ë¦¬ì¦˜ì„ ì‚¬ìš©í•œë‹¤ë©´ ì„œëª…ì€ ë‹¤ìŒê³¼ ê°™ì€ ë°©ì‹ìœ¼ë¡œ ë§Œë“¤ì–´ì§ˆ ê²ƒì…ë‹ˆë‹¤:

```ts
HMACSHA256(base64UrlEncode(header) + "." + base64UrlEncode(payload), secretKey);
```

## ğŸ“Œ JWT ì‚¬ìš© ì˜ˆì œ

ì•„ê¹Œ payloadì—ì„œ upbit apiê°€ ì‚¬ìš©í•˜ëŠ” payload ì˜ˆì œë¥¼ ì‚¬ìš©í–ˆìœ¼ë‹ˆ, ë‹¤ì‹œ í•œë²ˆ [upbit api](https://docs.upbit.com/reference/%EC%A3%BC%EB%AC%B8-%EA%B0%80%EB%8A%A5-%EC%A0%95%EB%B3%B4)ë¥¼ ì‚¬ìš©í•´ì„œ ë§ˆì¼“ë³„ ì£¼ë¬¸ ê°€ëŠ¥ ì •ë³´ë¥¼ í™•ì¸í•˜ëŠ” apiì˜ ì„œë¹„ìŠ¤ ë¶€ë¶„ ì˜ˆì œë¥¼ ë§Œë“¤ì–´ë³´ê² ìŠµë‹ˆë‹¤.

```ts
import jwt from "jsonwebtoken";
import { v4 as uuidv4 } from "uuid";
import axios from "axios";

export const getUserAccount = async (
  market: string,
  accessKey: string,
  secretKey: string
) => {
  const apiUrl = "https://api.upbit.com/v1/orders/chance";

  try {
    const query = `market=${market}`;
    const queryHash = crypto.createHash("sha512").update(query).digest("hex");

    const payload = {
      access_key: accessKey,
      nonce: uuidv4(),
      query_hash: queryHash,
      query_hash_alg: "SHA512",
    };
    const token = jwt.sign(payload, secretKey);
    const response = await axios.get(apiUrl, {
      params: {
        market,
      },
      headers: {
        Authorization: `Bearer ${token}`,
        accept: "application/json",
      },
    });
    return response.data;
  } catch (error) {
    console.error("Error fetching upbit order chance:", error);
    return {};
  }
};
```

- âœ… `query_hash`: parameterê°€ ìˆëŠ” apiê¸° ë•Œë¬¸ì— íŒŒë¼ë¯¸í„° ë¬´ê²°ì„± ê²€ì¦ê³¼ì • í•„ìš”
- âœ… `nonce`: í•­ìƒ ë‹¤ë¥´ê²Œ ì„¤ì •í•´ì•¼ í•¨ (uuidv4() ì‚¬ìš©)
- âœ… `jwt.sign(payload, secretKey)` â†’ JWT ìƒì„±
- âœ… API ìš”ì²­ ì‹œ `Authorization: Bearer ${JWT}` â†’ JWT ì¸ì¦

ì´ì œ ì´ë ‡ê²Œ ë§Œë“¤ì–´ì§„ apië¥¼ ì‚¬ìš©í•´ í´ë¼ì´ì–¸íŠ¸ì—ì„œ ë§ˆì¼“ë³„ ì£¼ë¬¸ ê°€ëŠ¥ ì •ë³´ë¥¼ ì¡°íšŒí•˜ë©´:

- 1ï¸âƒ£ í´ë¼ì´ì–¸íŠ¸ê°€ ìš”ì²­ ğŸ”½
- 2ï¸âƒ£ ì„œë²„ê°€ JWT ìƒì„± (jwt.sign)í›„ upbit API ìš”ì²­ ì‹œ JWT í¬í•¨ ğŸ”½
- 3ï¸âƒ£ upbit ì„œë²„ê°€ JWT ê²€ì¦ (jwt.verify) í›„ ì‘ë‹µ

ì´ ê³¼ì •ì„ ê±°ì³ì„œ ì‚¬ìš©ìì—ê²Œ ì‘ë‹µì„ ì œê³µí•©ë‹ˆë‹¤.

<span style="font-size: 20px; color:rgb(196, 196, 196)">ğŸ“– ì°¸ê³  ë§í¬</span>

- [jwt ê³µì‹ introduction](https://jwt.io/introduction)
- [ì—…ë¹„íŠ¸ open api docs](https://docs.upbit.com/docs/create-authorization-request)
